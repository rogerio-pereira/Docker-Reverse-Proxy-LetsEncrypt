version: "3.7"
services: 
    #nginx
    nginx-proxy:
        image: ubuntu/nginx
        restart: unless-stopped
        build: 
            context: ./
            dockerfile: Dockerfile
        entrypoint: ["bash", "-c", "
            certbot --nginx -n --redirect --agree-to 
            -d beawebartisan.com 
            -d site7.beawebartisan.com 
            -d site8.beawebartisan.com 
            -m hi@rogeriopereira.dev
            && certbot renew --dry-run
        "]
        ports:
             - 80:80
             - 443:443
        volumes:
            # - ./:/var/www
            - ./docker/nginx/config:/etc/nginx/conf.d
            # - ./docker/nginx/html:/var/www/html
            - certs:/etc/letsencrypt
        networks:
            - proxy
    #nginx
    # letsencrypt:
    #     build: 
    #         context: ./
    #         dockerfile: Dockerfile
    #     volumes:
    #         # - ./docker/nginx/config:/etc/nginx/conf.d
    #         - ./certs:/etc/letsencrypt
    #     networks:
    #         - proxy
    #     depends_on:
    #         - nginx-proxy
    
networks:
    proxy:
        driver: bridge
        external: true
volumes:
    certs: